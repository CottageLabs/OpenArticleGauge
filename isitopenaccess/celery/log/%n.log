[2013-01-22 10:32:29,863: WARNING/MainProcess] celery@holly ready.
[2013-01-22 10:32:29,871: INFO/MainProcess] consumer: Connected to redis://localhost:6379//.
[2013-01-22 10:36:21,264: INFO/MainProcess] Got task from broker: slavedriver.webfetch.plos_lookup[e9eae983-9660-4fd3-ac3e-74ae377750a1]
[2013-01-22 10:36:21,287: INFO/MainProcess] Task slavedriver.webfetch.plos_lookup[e9eae983-9660-4fd3-ac3e-74ae377750a1] succeeded in 0.00449204444885s: u'delay - DOI?'
[2013-01-22 10:36:25,106: INFO/MainProcess] Got task from broker: slavedriver.webfetch.plos_lookup[3c9145fd-19ea-44a7-b429-f127227841d6]
[2013-01-22 10:36:25,159: INFO/MainProcess] Task slavedriver.webfetch.plos_lookup[3c9145fd-19ea-44a7-b429-f127227841d6] succeeded in 0.00476408004761s: u'delay - DOI?'
[2013-01-27 17:32:59,000: WARNING/MainProcess] celery@holly ready.
[2013-01-27 17:32:59,010: INFO/MainProcess] consumer: Connected to redis://localhost:6379//.
[2013-01-27 17:57:33,966: WARNING/MainProcess] celery@holly ready.
[2013-01-27 17:57:33,974: INFO/MainProcess] consumer: Connected to redis://localhost:6379//.
[2013-01-27 18:03:21,707: WARNING/MainProcess] celery@holly ready.
[2013-01-27 18:03:21,715: INFO/MainProcess] consumer: Connected to redis://localhost:6379//.
[2013-01-27 18:04:05,667: INFO/MainProcess] Got task from broker: slavedriver.workers.detect_provider[a1efdf0a-ffc3-444a-9728-ab6aed6e2d5e]
[2013-01-27 18:04:05,727: INFO/MainProcess] Got task from broker: slavedriver.workers.provider_site_plugins[2b9c5e58-c69e-47da-bdf6-73f4af4d9bdd]
[2013-01-27 18:04:05,728: INFO/MainProcess] Task slavedriver.workers.detect_provider[a1efdf0a-ffc3-444a-9728-ab6aed6e2d5e] succeeded in 0.0178081989288s: {u'canonical': u'doi:123456', u'type':...
[2013-01-27 18:04:05,761: INFO/MainProcess] Got task from broker: slavedriver.workers.provider_page_plugins[d3bc0e63-0617-461a-83d9-1a7ed839970d]
[2013-01-27 18:04:05,763: INFO/MainProcess] Task slavedriver.workers.provider_site_plugins[2b9c5e58-c69e-47da-bdf6-73f4af4d9bdd] succeeded in 0.0177299976349s: {u'canonical': u'doi:123456', u'type':...
[2013-01-27 18:04:05,771: INFO/MainProcess] Task slavedriver.workers.provider_page_plugins[d3bc0e63-0617-461a-83d9-1a7ed839970d] succeeded in 0.00615000724792s: {u'queued': True, 'licence': {'url':...
[2013-02-12 21:29:45,689: WARNING/MainProcess] celery@holly ready.
[2013-02-12 21:29:45,699: INFO/MainProcess] consumer: Connected to redis://localhost:6379//.
[2013-02-12 21:29:45,722: ERROR/MainProcess] Received unregistered task of type u'slavedriver.workers.detect_provider'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you are using relative imports?
More: http://docs.celeryq.org/en/latest/userguide/tasks.html#names

The full contents of the message body was:
{u'utc': True, u'chord': None, u'args': [{u'canonical': u'doi:123456', u'type': u'doi', u'id': u'123456', u'queued': True}], u'retries': 0, u'expires': None, u'task': u'slavedriver.workers.detect_provider', u'callbacks': [{u'task': u'slavedriver.workers.provider_site_plugins', u'args': [], u'options': {u'link': [{u'task': u'slavedriver.workers.provider_page_plugins', u'args': [], u'options': {u'task_id': u'bbf1cb48-38a7-4b0d-a60e-ccadb2834048'}, u'subtask_type': None, u'kwargs': {}, u'immutable': False}], u'task_id': u'b75a4264-f1b4-46f6-8c6d-864af804500e'}, u'subtask_type': None, u'kwargs': {}, u'immutable': False}], u'errbacks': None, u'taskset': None, u'kwargs': {}, u'eta': None, u'id': u'196c5e2c-73c9-4725-8c68-6877c50f50ee'} (699b)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/celery/worker/consumer.py", line 435, in on_task_received
    strategies[name](message, body, message.ack_log_error)
KeyError: u'slavedriver.workers.detect_provider'
[2013-02-12 21:35:50,638: ERROR/MainProcess] Received unregistered task of type u'workflow.detect_provider'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you are using relative imports?
More: http://docs.celeryq.org/en/latest/userguide/tasks.html#names

The full contents of the message body was:
{u'utc': True, u'chord': None, u'args': [{u'identifier': {u'type': u'doi', u'id': u'10.1', u'canonical': u'doi:10.1'}, u'queued': True}], u'retries': 0, u'expires': None, u'task': u'workflow.detect_provider', u'callbacks': [{u'task': u'workflow.provider_licence', u'args': [], u'options': {u'link': [{u'task': u'workflow.store_results', u'args': [], u'options': {u'task_id': u'61f60539-0397-4d80-bd49-f65d2de3f10c'}, u'subtask_type': None, u'kwargs': {}, u'immutable': False}], u'task_id': u'1b278029-07ab-4adf-b996-f2d8f45c8c02'}, u'subtask_type': None, u'kwargs': {}, u'immutable': False}], u'errbacks': None, u'taskset': None, u'kwargs': {}, u'eta': None, u'id': u'cd491009-1307-47d8-ba41-4c0b0940e0b2'} (665b)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/celery/worker/consumer.py", line 435, in on_task_received
    strategies[name](message, body, message.ack_log_error)
KeyError: u'workflow.detect_provider'
[2013-02-12 21:39:09,890: WARNING/MainProcess] celery@holly ready.
[2013-02-12 21:39:09,898: INFO/MainProcess] consumer: Connected to redis://localhost:6379//.
[2013-02-12 21:41:10,654: WARNING/MainProcess] celery@holly ready.
[2013-02-12 21:41:10,663: INFO/MainProcess] consumer: Connected to redis://localhost:6379//.
[2013-02-12 21:43:05,288: INFO/MainProcess] Got task from broker: workflow.detect_provider[ff217b12-9c5c-4ea2-af71-2f7b6edae0a2]
[2013-02-12 21:43:05,316: ERROR/MainProcess] Task workflow.detect_provider[ff217b12-9c5c-4ea2-af71-2f7b6edae0a2] raised exception: TypeError("'NoneType' object is not callable",)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/celery/task/trace.py", line 224, in trace_task
    R = retval = fun(*args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/celery/task/trace.py", line 407, in __protected_call__
    return self.run(*args, **kwargs)
  File "/home/richard/Code/External/IsItOpenAccess/src/workflow.py", line 259, in detect_provider
    plugin(record)
TypeError: 'NoneType' object is not callable
[2013-02-12 21:44:01,971: INFO/MainProcess] Got task from broker: workflow.detect_provider[dc01b812-02e1-42ec-a93c-f999f067e810]
[2013-02-12 21:44:02,020: ERROR/MainProcess] Task workflow.detect_provider[dc01b812-02e1-42ec-a93c-f999f067e810] raised exception: TypeError("'NoneType' object is not callable",)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/celery/task/trace.py", line 224, in trace_task
    R = retval = fun(*args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/celery/task/trace.py", line 407, in __protected_call__
    return self.run(*args, **kwargs)
  File "/home/richard/Code/External/IsItOpenAccess/src/workflow.py", line 259, in detect_provider
    plugin(record)
TypeError: 'NoneType' object is not callable
[2013-02-12 21:44:57,972: WARNING/MainProcess] celery@holly ready.
[2013-02-12 21:44:57,980: INFO/MainProcess] consumer: Connected to redis://localhost:6379//.
[2013-02-12 21:45:54,234: INFO/MainProcess] Got task from broker: workflow.detect_provider[1ebc99d5-cbf0-47c5-b744-df1406ce57a8]
[2013-02-12 21:45:54,290: ERROR/MainProcess] Task workflow.detect_provider[1ebc99d5-cbf0-47c5-b744-df1406ce57a8] raised exception: TypeError("'NoneType' object is not callable",)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/celery/task/trace.py", line 224, in trace_task
    R = retval = fun(*args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/celery/task/trace.py", line 407, in __protected_call__
    return self.run(*args, **kwargs)
  File "/home/richard/Code/External/IsItOpenAccess/src/workflow.py", line 259, in detect_provider
    plugin(record)
TypeError: 'NoneType' object is not callable
[2013-02-12 21:46:13,342: DEBUG/MainProcess] [Worker] Loading modules.
[2013-02-12 21:46:13,405: DEBUG/MainProcess] [Worker] Claiming components.
[2013-02-12 21:46:13,406: DEBUG/MainProcess] [Worker] Building boot step graph.
[2013-02-12 21:46:13,407: DEBUG/MainProcess] [Worker] New boot order: {ev, queues, beat, pool, mediator, autoreloader, timers, state-db, autoscaler, consumer}
[2013-02-12 21:46:13,414: DEBUG/MainProcess] Starting celery.worker.hub.Hub...
[2013-02-12 21:46:13,414: DEBUG/MainProcess] celery.worker.hub.Hub OK!
[2013-02-12 21:46:13,415: DEBUG/MainProcess] Starting celery.concurrency.processes.TaskPool...
[2013-02-12 21:46:13,434: DEBUG/MainProcess] celery.concurrency.processes.TaskPool OK!
[2013-02-12 21:46:13,435: DEBUG/MainProcess] Starting celery.worker.mediator.Mediator...
[2013-02-12 21:46:13,436: DEBUG/MainProcess] celery.worker.mediator.Mediator OK!
[2013-02-12 21:46:13,437: DEBUG/MainProcess] Starting celery.worker.consumer.Consumer...
[2013-02-12 21:46:13,438: WARNING/MainProcess] celery@holly ready.
[2013-02-12 21:46:13,439: DEBUG/MainProcess] consumer: Re-establishing connection to the broker...
[2013-02-12 21:46:13,445: INFO/MainProcess] consumer: Connected to redis://localhost:6379//.
[2013-02-12 21:46:13,449: DEBUG/MainProcess] consumer: basic.qos: prefetch_count->16
[2013-02-12 21:46:13,462: DEBUG/MainProcess] consumer: Ready to accept tasks!
[2013-02-12 21:46:18,569: INFO/MainProcess] Got task from broker: workflow.detect_provider[0b365897-4a7c-4bdf-aaf3-7f47f38097ee]
[2013-02-12 21:46:18,609: DEBUG/MainProcess] Mediator: Running callback for task: workflow.detect_provider[0b365897-4a7c-4bdf-aaf3-7f47f38097ee]
[2013-02-12 21:46:18,610: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x1f66848> (args:(u'workflow.detect_provider', u'0b365897-4a7c-4bdf-aaf3-7f47f38097ee', [{u'identifier': {u'type': u'doi', u'id': u'10.1', u'canonical': u'doi:10.1'}, u'queued': True}], {}, {u'utc': True, 'is_eager': False, u'chord': None, 'group': None, u'args': [{u'identifier': {u'type': u'doi', u'id': u'10.1', u'canonical': u'doi:10.1'}, u'queued': True}], u'retries': 0, 'delivery_info': {'priority': 0, 'routing_key': 'celery', 'exchange': 'celery'}, u'expires': None, u'task': u'workflow.detect_provider', u'callbacks': None, u'errbacks': None, 'hostname': 'holly', u'taskset': None, u'kwargs': {}, u'eta': None, u'id': u'0b365897-4a7c-4bdf-aaf3-7f47f38097ee'}) kwargs:{})
[2013-02-12 21:46:18,614: DEBUG/MainProcess] Task accepted: workflow.detect_provider[0b365897-4a7c-4bdf-aaf3-7f47f38097ee] pid:27382
[2013-02-12 21:46:18,614: DEBUG/MainProcess] applying plugin plugins.doi.provider_range_lookup
[2013-02-12 21:46:18,622: ERROR/MainProcess] Task workflow.detect_provider[0b365897-4a7c-4bdf-aaf3-7f47f38097ee] raised exception: TypeError("'NoneType' object is not callable",)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/celery/task/trace.py", line 224, in trace_task
    R = retval = fun(*args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/celery/task/trace.py", line 407, in __protected_call__
    return self.run(*args, **kwargs)
  File "/home/richard/Code/External/IsItOpenAccess/src/workflow.py", line 259, in detect_provider
    plugin(record)
TypeError: 'NoneType' object is not callable
[2013-02-12 21:59:25,756: DEBUG/MainProcess] Stopping celery.worker.consumer.Consumer...
[2013-02-12 21:59:25,757: DEBUG/MainProcess] consumer: Stopping consumers...
[2013-02-12 21:59:25,757: DEBUG/MainProcess] Stopping celery.worker.mediator.Mediator...
[2013-02-12 21:59:26,157: DEBUG/MainProcess] Stopping celery.concurrency.processes.TaskPool...
[2013-02-12 21:59:26,167: DEBUG/MainProcess] Stopping celery.worker.hub.Hub...
[2013-02-12 21:59:26,167: DEBUG/MainProcess] consumer: Closing consumer channel...
[2013-02-12 21:59:26,168: DEBUG/MainProcess] consumer: Closing broadcast channel...
[2013-02-12 21:59:26,171: DEBUG/MainProcess] consumer: Closing broker connection...
[2013-02-12 21:59:27,676: DEBUG/MainProcess] [Worker] Loading modules.
[2013-02-12 21:59:27,737: DEBUG/MainProcess] [Worker] Claiming components.
[2013-02-12 21:59:27,738: DEBUG/MainProcess] [Worker] Building boot step graph.
[2013-02-12 21:59:27,739: DEBUG/MainProcess] [Worker] New boot order: {ev, queues, beat, pool, mediator, autoreloader, timers, state-db, autoscaler, consumer}
[2013-02-12 21:59:27,745: DEBUG/MainProcess] Starting celery.worker.hub.Hub...
[2013-02-12 21:59:27,746: DEBUG/MainProcess] celery.worker.hub.Hub OK!
[2013-02-12 21:59:27,747: DEBUG/MainProcess] Starting celery.concurrency.processes.TaskPool...
[2013-02-12 21:59:27,766: DEBUG/MainProcess] celery.concurrency.processes.TaskPool OK!
[2013-02-12 21:59:27,768: DEBUG/MainProcess] Starting celery.worker.mediator.Mediator...
[2013-02-12 21:59:27,769: DEBUG/MainProcess] celery.worker.mediator.Mediator OK!
[2013-02-12 21:59:27,770: DEBUG/MainProcess] Starting celery.worker.consumer.Consumer...
[2013-02-12 21:59:27,771: WARNING/MainProcess] celery@holly ready.
[2013-02-12 21:59:27,772: DEBUG/MainProcess] consumer: Re-establishing connection to the broker...
[2013-02-12 21:59:27,778: INFO/MainProcess] consumer: Connected to redis://localhost:6379//.
[2013-02-12 21:59:27,782: DEBUG/MainProcess] consumer: basic.qos: prefetch_count->16
[2013-02-12 21:59:27,795: DEBUG/MainProcess] consumer: Ready to accept tasks!
[2013-02-12 21:59:37,233: INFO/MainProcess] Got task from broker: workflow.detect_provider[87994af6-dd4f-47bd-8b8e-5d90c50dd056]
[2013-02-12 21:59:37,243: DEBUG/MainProcess] Mediator: Running callback for task: workflow.detect_provider[87994af6-dd4f-47bd-8b8e-5d90c50dd056]
[2013-02-12 21:59:37,244: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x2665848> (args:(u'workflow.detect_provider', u'87994af6-dd4f-47bd-8b8e-5d90c50dd056', [{u'identifier': {u'type': u'doi', u'id': u'10.1', u'canonical': u'doi:10.1'}, u'queued': True}], {}, {u'utc': True, 'is_eager': False, u'chord': None, 'group': None, u'args': [{u'identifier': {u'type': u'doi', u'id': u'10.1', u'canonical': u'doi:10.1'}, u'queued': True}], u'retries': 0, 'delivery_info': {'priority': 0, 'routing_key': 'celery', 'exchange': 'celery'}, u'expires': None, u'task': u'workflow.detect_provider', u'callbacks': None, u'errbacks': None, 'hostname': 'holly', u'taskset': None, u'kwargs': {}, u'eta': None, u'id': u'87994af6-dd4f-47bd-8b8e-5d90c50dd056'}) kwargs:{})
[2013-02-12 21:59:37,247: DEBUG/MainProcess] Task accepted: workflow.detect_provider[87994af6-dd4f-47bd-8b8e-5d90c50dd056] pid:27492
[2013-02-12 21:59:37,246: DEBUG/MainProcess] loading plugin from modpath: plugins.doi, and callable: provider_range_lookup
[2013-02-12 21:59:37,248: DEBUG/MainProcess] import error loading provider_range_lookup from plugins.doi - path may not be accessible or available in this context
[2013-02-12 21:59:37,249: DEBUG/MainProcess] import error loading provider_range_lookup from iioa.plugins.doi - path may not be accessible or available in this context
[2013-02-12 21:59:37,249: DEBUG/MainProcess] unable to load plugin provider_range_lookup from plugins.doi
[2013-02-12 21:59:37,249: DEBUG/MainProcess] applying plugin plugins.doi.provider_range_lookup
[2013-02-12 21:59:37,256: ERROR/MainProcess] Task workflow.detect_provider[87994af6-dd4f-47bd-8b8e-5d90c50dd056] raised exception: TypeError("'NoneType' object is not callable",)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/celery/task/trace.py", line 224, in trace_task
    R = retval = fun(*args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/celery/task/trace.py", line 407, in __protected_call__
    return self.run(*args, **kwargs)
  File "/home/richard/Code/External/IsItOpenAccess/src/workflow.py", line 259, in detect_provider
    plugin(record)
TypeError: 'NoneType' object is not callable
[2013-02-12 22:15:07,131: DEBUG/MainProcess] Stopping celery.worker.consumer.Consumer...
[2013-02-12 22:15:07,131: DEBUG/MainProcess] consumer: Stopping consumers...
[2013-02-12 22:15:07,132: DEBUG/MainProcess] Stopping celery.worker.mediator.Mediator...
[2013-02-12 22:15:07,911: DEBUG/MainProcess] Stopping celery.concurrency.processes.TaskPool...
[2013-02-12 22:15:07,918: DEBUG/MainProcess] Stopping celery.worker.hub.Hub...
[2013-02-12 22:15:07,919: DEBUG/MainProcess] consumer: Closing consumer channel...
[2013-02-12 22:15:07,919: DEBUG/MainProcess] consumer: Closing broadcast channel...
[2013-02-12 22:15:07,922: DEBUG/MainProcess] consumer: Closing broker connection...
[2013-02-12 22:17:14,056: DEBUG/MainProcess] [Worker] Loading modules.
[2013-02-12 22:17:14,120: DEBUG/MainProcess] [Worker] Claiming components.
[2013-02-12 22:17:14,120: DEBUG/MainProcess] [Worker] Building boot step graph.
[2013-02-12 22:17:14,122: DEBUG/MainProcess] [Worker] New boot order: {ev, queues, beat, pool, mediator, autoreloader, timers, state-db, autoscaler, consumer}
[2013-02-12 22:17:14,128: DEBUG/MainProcess] Starting celery.worker.hub.Hub...
[2013-02-12 22:17:14,129: DEBUG/MainProcess] celery.worker.hub.Hub OK!
[2013-02-12 22:17:14,129: DEBUG/MainProcess] Starting celery.concurrency.processes.TaskPool...
[2013-02-12 22:17:14,147: DEBUG/MainProcess] celery.concurrency.processes.TaskPool OK!
[2013-02-12 22:17:14,149: DEBUG/MainProcess] Starting celery.worker.mediator.Mediator...
[2013-02-12 22:17:14,151: DEBUG/MainProcess] celery.worker.mediator.Mediator OK!
[2013-02-12 22:17:14,152: DEBUG/MainProcess] Starting celery.worker.consumer.Consumer...
[2013-02-12 22:17:14,153: WARNING/MainProcess] celery@holly ready.
[2013-02-12 22:17:14,154: DEBUG/MainProcess] consumer: Re-establishing connection to the broker...
[2013-02-12 22:17:14,161: INFO/MainProcess] consumer: Connected to redis://localhost:6379//.
[2013-02-12 22:17:14,165: DEBUG/MainProcess] consumer: basic.qos: prefetch_count->16
[2013-02-12 22:17:14,182: DEBUG/MainProcess] consumer: Ready to accept tasks!
[2013-02-12 22:18:16,020: INFO/MainProcess] Got task from broker: workflow.detect_provider[ed5f8834-a1e6-47c5-b7fd-0015e65bc2cb]
[2013-02-12 22:18:16,064: DEBUG/MainProcess] Mediator: Running callback for task: workflow.detect_provider[ed5f8834-a1e6-47c5-b7fd-0015e65bc2cb]
[2013-02-12 22:18:16,065: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x1f21578> (args:(u'workflow.detect_provider', u'ed5f8834-a1e6-47c5-b7fd-0015e65bc2cb', [{u'identifier': {u'type': u'doi', u'id': u'10.1', u'canonical': u'doi:10.1'}, u'queued': True}], {}, {u'utc': True, 'is_eager': False, u'chord': None, 'group': None, u'args': [{u'identifier': {u'type': u'doi', u'id': u'10.1', u'canonical': u'doi:10.1'}, u'queued': True}], u'retries': 0, 'delivery_info': {'priority': 0, 'routing_key': 'celery', 'exchange': 'celery'}, u'expires': None, u'task': u'workflow.detect_provider', u'callbacks': None, u'errbacks': None, 'hostname': 'holly', u'taskset': None, u'kwargs': {}, u'eta': None, u'id': u'ed5f8834-a1e6-47c5-b7fd-0015e65bc2cb'}) kwargs:{})
[2013-02-12 22:18:16,067: DEBUG/MainProcess] loading plugin from modpath: plugins.doi, and callable: provider_range_lookup
[2013-02-12 22:18:16,068: DEBUG/MainProcess] Task accepted: workflow.detect_provider[ed5f8834-a1e6-47c5-b7fd-0015e65bc2cb] pid:27635
[2013-02-12 22:18:16,069: DEBUG/MainProcess] import error loading provider_range_lookup from plugins.doi - path may not be accessible or available in this context
[2013-02-12 22:18:16,071: DEBUG/MainProcess] import error loading provider_range_lookup from isitopenaccess.plugins.doi - path may not be accessible or available in this context
[2013-02-12 22:18:16,071: DEBUG/MainProcess] unable to load plugin provider_range_lookup from plugins.doi
[2013-02-12 22:18:16,072: DEBUG/MainProcess] applying plugin plugins.doi.provider_range_lookup
[2013-02-12 22:18:16,081: ERROR/MainProcess] Task workflow.detect_provider[ed5f8834-a1e6-47c5-b7fd-0015e65bc2cb] raised exception: TypeError("'NoneType' object is not callable",)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/celery/task/trace.py", line 224, in trace_task
    R = retval = fun(*args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/celery/task/trace.py", line 407, in __protected_call__
    return self.run(*args, **kwargs)
  File "/home/richard/Code/External/IsItOpenAccess/src/workflow.py", line 259, in detect_provider
    plugin(record)
TypeError: 'NoneType' object is not callable
[2013-02-12 22:18:22,217: ERROR/MainProcess] consumer: Connection to broker lost. Trying to re-establish the connection...
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/celery/worker/consumer.py", line 393, in start
    self.consume_messages()
  File "/usr/local/lib/python2.7/dist-packages/celery/worker/consumer.py", line 464, in consume_messages
    update_readers(on_poll_start())
  File "/usr/local/lib/python2.7/dist-packages/kombu/transport/redis.py", line 745, in on_poll_start
    cycle.on_poll_start()
  File "/usr/local/lib/python2.7/dist-packages/kombu/transport/redis.py", line 248, in on_poll_start
    self._register_BRPOP(channel)
  File "/usr/local/lib/python2.7/dist-packages/kombu/transport/redis.py", line 231, in _register_BRPOP
    self._register(*ident)
  File "/usr/local/lib/python2.7/dist-packages/kombu/transport/redis.py", line 216, in _register
    client.connection.connect()
  File "/usr/local/lib/python2.7/dist-packages/redis/connection.py", line 231, in connect
    raise ConnectionError(self._error_message(e))
ConnectionError: Error 111 connecting localhost:6379. Connection refused.
[2013-02-12 22:18:22,222: DEBUG/MainProcess] consumer: Re-establishing connection to the broker...
[2013-02-12 22:18:22,223: DEBUG/MainProcess] consumer: Heart: Going into cardiac arrest...
[2013-02-12 22:18:22,223: DEBUG/MainProcess] consumer: Cancelling task consumer...
[2013-02-12 22:18:22,223: DEBUG/MainProcess] consumer: Shutting down event dispatcher...
[2013-02-12 22:18:22,224: DEBUG/MainProcess] consumer: Cancelling broadcast consumer...
[2013-02-12 22:18:22,224: DEBUG/MainProcess] consumer: Closing consumer channel...
[2013-02-12 22:18:22,225: DEBUG/MainProcess] consumer: Closing broadcast channel...
[2013-02-12 22:18:22,226: DEBUG/MainProcess] consumer: Closing broker connection...
[2013-02-12 22:18:22,230: ERROR/MainProcess] consumer: Cannot connect to redis://localhost:6379//: Error 111 connecting localhost:6379. Connection refused..
Trying again in 2.00 seconds...

[2013-02-12 22:18:24,234: ERROR/MainProcess] consumer: Cannot connect to redis://localhost:6379//: Error 111 connecting localhost:6379. Connection refused..
Trying again in 4.00 seconds...

[2013-02-12 22:18:28,242: INFO/MainProcess] consumer: Connected to redis://localhost:6379//.
[2013-02-12 22:18:28,245: DEBUG/MainProcess] consumer: basic.qos: prefetch_count->16
[2013-02-12 22:18:28,253: DEBUG/MainProcess] consumer: Ready to accept tasks!
[2013-02-12 22:23:45,790: DEBUG/MainProcess] [Worker] Loading modules.
[2013-02-12 22:23:45,851: DEBUG/MainProcess] [Worker] Claiming components.
[2013-02-12 22:23:45,852: DEBUG/MainProcess] [Worker] Building boot step graph.
[2013-02-12 22:23:45,853: DEBUG/MainProcess] [Worker] New boot order: {ev, queues, beat, pool, mediator, autoreloader, timers, state-db, autoscaler, consumer}
[2013-02-12 22:23:45,860: DEBUG/MainProcess] Starting celery.worker.hub.Hub...
[2013-02-12 22:23:45,861: DEBUG/MainProcess] celery.worker.hub.Hub OK!
[2013-02-12 22:23:45,862: DEBUG/MainProcess] Starting celery.concurrency.processes.TaskPool...
[2013-02-12 22:23:45,881: DEBUG/MainProcess] celery.concurrency.processes.TaskPool OK!
[2013-02-12 22:23:45,883: DEBUG/MainProcess] Starting celery.worker.mediator.Mediator...
[2013-02-12 22:23:45,884: DEBUG/MainProcess] celery.worker.mediator.Mediator OK!
[2013-02-12 22:23:45,885: DEBUG/MainProcess] Starting celery.worker.consumer.Consumer...
[2013-02-12 22:23:45,886: WARNING/MainProcess] celery@holly ready.
[2013-02-12 22:23:45,886: DEBUG/MainProcess] consumer: Re-establishing connection to the broker...
[2013-02-12 22:23:45,894: INFO/MainProcess] consumer: Connected to redis://localhost:6379//.
[2013-02-12 22:23:45,897: DEBUG/MainProcess] consumer: basic.qos: prefetch_count->16
[2013-02-12 22:23:45,911: DEBUG/MainProcess] consumer: Ready to accept tasks!
[2013-02-12 22:23:55,394: INFO/MainProcess] Got task from broker: workflow.detect_provider[a6c6a235-295b-4341-afd6-64632651498a]
[2013-02-12 22:23:55,414: DEBUG/MainProcess] Mediator: Running callback for task: workflow.detect_provider[a6c6a235-295b-4341-afd6-64632651498a]
[2013-02-12 22:23:55,414: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x268f5f0> (args:(u'workflow.detect_provider', u'a6c6a235-295b-4341-afd6-64632651498a', [{u'identifier': {u'type': u'doi', u'id': u'10.1', u'canonical': u'doi:10.1'}, u'queued': True}], {}, {u'utc': True, 'is_eager': False, u'chord': None, 'group': None, u'args': [{u'identifier': {u'type': u'doi', u'id': u'10.1', u'canonical': u'doi:10.1'}, u'queued': True}], u'retries': 0, 'delivery_info': {'priority': 0, 'routing_key': 'celery', 'exchange': 'celery'}, u'expires': None, u'task': u'workflow.detect_provider', u'callbacks': None, u'errbacks': None, 'hostname': 'holly', u'taskset': None, u'kwargs': {}, u'eta': None, u'id': u'a6c6a235-295b-4341-afd6-64632651498a'}) kwargs:{})
[2013-02-12 22:23:55,417: DEBUG/MainProcess] Task accepted: workflow.detect_provider[a6c6a235-295b-4341-afd6-64632651498a] pid:27826
[2013-02-12 22:23:55,417: DEBUG/MainProcess] loading plugin from modpath: plugins.doi, and callable: provider_range_lookup
[2013-02-12 22:23:55,419: DEBUG/MainProcess] import error loading provider_range_lookup from plugins.doi - path may not be accessible or available in this context
[2013-02-12 22:23:55,423: DEBUG/MainProcess] import error loading provider_range_lookup from isitopenaccess.plugins.doi - path may not be accessible or available in this context
[2013-02-12 22:23:55,423: DEBUG/MainProcess] unable to load plugin provider_range_lookup from plugins.doi
[2013-02-12 22:23:55,424: DEBUG/MainProcess] applying plugin plugins.doi.provider_range_lookup
[2013-02-12 22:23:55,434: ERROR/MainProcess] Task workflow.detect_provider[a6c6a235-295b-4341-afd6-64632651498a] raised exception: TypeError("'NoneType' object is not callable",)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/celery/task/trace.py", line 224, in trace_task
    R = retval = fun(*args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/celery/task/trace.py", line 407, in __protected_call__
    return self.run(*args, **kwargs)
  File "/home/richard/Code/External/IsItOpenAccess/isitopenaccess/workflow.py", line 259, in detect_provider
    plugin(record)
TypeError: 'NoneType' object is not callable
[2013-02-12 22:37:04,604: DEBUG/MainProcess] Stopping celery.worker.consumer.Consumer...
[2013-02-12 22:37:04,605: DEBUG/MainProcess] consumer: Stopping consumers...
[2013-02-12 22:37:04,605: DEBUG/MainProcess] Stopping celery.worker.mediator.Mediator...
[2013-02-12 22:37:04,986: DEBUG/MainProcess] Stopping celery.concurrency.processes.TaskPool...
[2013-02-12 22:37:04,992: DEBUG/MainProcess] Stopping celery.worker.hub.Hub...
[2013-02-12 22:37:04,993: DEBUG/MainProcess] consumer: Closing consumer channel...
[2013-02-12 22:37:04,994: DEBUG/MainProcess] consumer: Closing broadcast channel...
[2013-02-12 22:37:04,996: DEBUG/MainProcess] consumer: Closing broker connection...
[2013-02-12 22:37:08,678: DEBUG/MainProcess] [Worker] Loading modules.
[2013-02-12 22:37:08,738: DEBUG/MainProcess] [Worker] Claiming components.
[2013-02-12 22:37:08,739: DEBUG/MainProcess] [Worker] Building boot step graph.
[2013-02-12 22:37:08,741: DEBUG/MainProcess] [Worker] New boot order: {ev, queues, beat, pool, mediator, autoreloader, timers, state-db, autoscaler, consumer}
[2013-02-12 22:37:08,747: DEBUG/MainProcess] Starting celery.worker.hub.Hub...
[2013-02-12 22:37:08,748: DEBUG/MainProcess] celery.worker.hub.Hub OK!
[2013-02-12 22:37:08,748: DEBUG/MainProcess] Starting celery.concurrency.processes.TaskPool...
[2013-02-12 22:37:08,766: DEBUG/MainProcess] celery.concurrency.processes.TaskPool OK!
[2013-02-12 22:37:08,768: DEBUG/MainProcess] Starting celery.worker.mediator.Mediator...
[2013-02-12 22:37:08,769: DEBUG/MainProcess] celery.worker.mediator.Mediator OK!
[2013-02-12 22:37:08,769: DEBUG/MainProcess] Starting celery.worker.consumer.Consumer...
[2013-02-12 22:37:08,770: WARNING/MainProcess] celery@holly ready.
[2013-02-12 22:37:08,771: DEBUG/MainProcess] consumer: Re-establishing connection to the broker...
[2013-02-12 22:37:08,778: INFO/MainProcess] consumer: Connected to redis://localhost:6379//.
[2013-02-12 22:37:08,781: DEBUG/MainProcess] consumer: basic.qos: prefetch_count->16
[2013-02-12 22:37:08,795: DEBUG/MainProcess] consumer: Ready to accept tasks!
[2013-02-12 22:37:24,545: INFO/MainProcess] Got task from broker: workflow.detect_provider[61e031fb-d167-416d-94fd-7ce3a8a00054]
[2013-02-12 22:37:24,551: DEBUG/MainProcess] Mediator: Running callback for task: workflow.detect_provider[61e031fb-d167-416d-94fd-7ce3a8a00054]
[2013-02-12 22:37:24,553: DEBUG/MainProcess] TaskPool: Apply <function _fast_trace_task at 0x19c85f0> (args:(u'workflow.detect_provider', u'61e031fb-d167-416d-94fd-7ce3a8a00054', [{u'identifier': {u'type': u'doi', u'id': u'10.1', u'canonical': u'doi:10.1'}, u'queued': True}], {}, {u'utc': True, 'is_eager': False, u'chord': None, 'group': None, u'args': [{u'identifier': {u'type': u'doi', u'id': u'10.1', u'canonical': u'doi:10.1'}, u'queued': True}], u'retries': 0, 'delivery_info': {'priority': 0, 'routing_key': 'celery', 'exchange': 'celery'}, u'expires': None, u'task': u'workflow.detect_provider', u'callbacks': None, u'errbacks': None, 'hostname': 'holly', u'taskset': None, u'kwargs': {}, u'eta': None, u'id': u'61e031fb-d167-416d-94fd-7ce3a8a00054'}) kwargs:{})
[2013-02-12 22:37:24,555: DEBUG/MainProcess] loading plugin from modpath: plugins.doi, and callable: provider_range_lookup
[2013-02-12 22:37:24,556: DEBUG/MainProcess] Task accepted: workflow.detect_provider[61e031fb-d167-416d-94fd-7ce3a8a00054] pid:27888
[2013-02-12 22:37:24,557: DEBUG/MainProcess] import error loading provider_range_lookup from plugins.doi - path may not be accessible or available in this context
[2013-02-12 22:37:24,561: DEBUG/MainProcess] loaded plugin from plugins.doi: <function provider_range_lookup at 0x1dce7d0>
[2013-02-12 22:37:24,562: DEBUG/MainProcess] applying plugin plugins.doi.provider_range_lookup
[2013-02-12 22:37:24,562: DEBUG/MainProcess] loading plugin from modpath: plugins.doi, and callable: provider_dereference
[2013-02-12 22:37:24,563: DEBUG/MainProcess] import error loading provider_dereference from plugins.doi - path may not be accessible or available in this context
[2013-02-12 22:37:24,563: DEBUG/MainProcess] loaded plugin from plugins.doi: <function provider_dereference at 0x1dce848>
[2013-02-12 22:37:24,564: DEBUG/MainProcess] applying plugin plugins.doi.provider_dereference
[2013-02-12 22:37:24,568: INFO/MainProcess] Task workflow.detect_provider[61e031fb-d167-416d-94fd-7ce3a8a00054] succeeded in 0.0140500068665s: {u'identifier': {u'type': u'doi', u'id':...
